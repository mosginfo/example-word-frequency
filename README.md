## Ручная сборка и публикация

```shell
# Создаем виртуальное окружение
python3 -m venv env

# Активируем виртуальное окружение
. ./env/bin/activate

# Устанавливаем пакет для сборки других пакетов
pip install build

# Собираем пакет
python -m build

# Проверяем содержимое пакета
python -m zipfile -l dist/*.whl

# Устанавливаем утилиту для загрузки артефактов сборки в реестр
pip install twine

# Проверяем пакет перед публикацией
python -m twine check dist/*

# Загружаем артефакты сборки в тестовый реестр
python -m twine upload --repository testpypi -u __token__ dist/*
```

Связка пользователь/пароль устарела и не безопасна.
Поэтому для локальной публикации пакета (или иных действий с реестром),
лучше использовать токен доступа, а в качестве ими пользователя указать `__token__`.
В локальной разработке удобнее создать один токен с доступом ко всем проектам/пакетам,
но в других ситуациях токен нужно ограничить только одним проектом!

Чтобы каждый раз не вводить пароль,
храните данные в конфигурационном файле `.pypirc` в корне домашнего каталога:

```ini
[distutils]
index-servers =
    pypi
    testpypi

[pypi]
repository = https://upload.pypi.org/legacy/
username = __token__
password = <YOUR_TOKEN>

[testpypi]
repository = https://test.pypi.org/legacy/
username = __token__
password = <YOUR_TOKEN>
```

## Автоматизация сборки и публикации

Ручная сборка и публикации имеет место,
если вы хотите протестировать локально публикацию пакета,
однако современным подходом является автоматизация процесса публикации в CI/CD
и **Trusted Publishing (OIDC)** - доверенный издатель.

